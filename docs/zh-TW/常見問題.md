# 常見問題 - Google Classroom Manager Pro

## 安裝與設定

### Q1: 安裝後選單沒有出現，怎麼辦？

**A**: 請依照以下步驟檢查：

1. **確認權限授權**
   - 開啟 Google Apps Script 專案
   - 執行任一函式觸發授權流程
   - 確認已授權所有必要權限

2. **檢查程式碼部署**
   - 確認所有檔案都已正確上傳
   - 檢查檔案順序是否正確
   - 重新推送程式碼：`clasp push`

3. **清除瀏覽器快取**
   - 清除 Google Sheets 頁面的快取
   - 重新整理頁面
   - 等待 1-2 分鐘讓選單載入

4. **檢查 Google Apps Script 服務**
   - 確認 Google Classroom API 已啟用
   - 檢查服務版本是否為 v1

### Q2: 出現「權限不足」的錯誤訊息？

**A**: 這通常是權限範圍問題：

1. **檢查 OAuth 範圍**
   ```javascript
   // 確認以下權限已授權
   'https://www.googleapis.com/auth/classroom.courses'
   'https://www.googleapis.com/auth/classroom.rosters'
   'https://www.googleapis.com/auth/classroom.profile.emails'
   'https://www.googleapis.com/auth/classroom.profile.photos'
   ```

2. **重新授權**
   - 在 Google Apps Script 中撤銷所有授權
   - 重新執行函式觸發授權流程
   - 仔細檢查每個權限項目

3. **管理員權限**
   - 確認您的帳戶具備 Google Classroom 管理員權限
   - 聯絡您的 IT 管理員確認權限設定

### Q3: 如何更新到最新版本？

**A**: 更新步驟：

1. **使用 CLASP 更新**
   ```bash
   # 拉取最新版本
   clasp pull
   
   # 推送更新
   clasp push
   ```

2. **手動更新**
   - 下載最新版本的程式碼
   - 在 Google Apps Script 中更新對應檔案
   - 確認所有檔案都已更新

3. **驗證更新**
   - 檢查版本號是否正確
   - 測試主要功能是否正常運作

## 功能操作

### Q4: 批次處理中斷了，如何繼續？

**A**: 系統具備斷點續傳功能：

1. **檢查處理狀態**
   - 查看工作表中的「已處理」欄位
   - 確認哪些項目已完成處理

2. **繼續未完成的處理**
   - 刪除已完成的行（或標記為已處理）
   - 重新執行批次處理功能
   - 系統會自動跳過已處理的項目

3. **手動處理失敗項目**
   - 檢查錯誤訊息
   - 修正資料問題
   - 單獨處理失敗的項目

### Q5: 為什麼某些課程沒有出現在清單中？

**A**: 可能的原因：

1. **權限限制**
   - 您只能看到有權限存取的課程
   - 確認您是課程的擁有者或老師

2. **課程狀態**
   - 封存的課程可能不會顯示
   - 檢查課程狀態篩選設定

3. **網域限制**
   - 某些課程可能有網域存取限制
   - 確認您的帳戶網域設定

### Q6: 批次新增成員時出現重複怎麼辦？

**A**: 系統自動處理重複成員：

1. **自動檢測**
   - 系統會檢測已存在的成員
   - 自動跳過重複的 Email 地址

2. **錯誤處理**
   - 重複新增會顯示警告而非錯誤
   - 不會影響其他成員的新增

3. **資料清理**
   - 建議事先清理重複的資料
   - 使用 Google Sheets 的去重功能

## 效能與限制

### Q7: 處理速度很慢，如何優化？

**A**: 效能優化建議：

1. **調整批次大小**
   ```javascript
   // 在 Apps Script 中調整
   PropertiesService.getScriptProperties().setProperty('BATCH_SIZE', '25');
   ```

2. **使用快取**
   - 啟用系統快取功能
   - 避免重複查詢相同資料

3. **分散處理時間**
   - 避免在高峰時段操作
   - 分批處理大量資料

4. **監控 API 配額**
   - 檢查 Google Classroom API 使用量
   - 適當調整請求頻率

### Q8: 遇到 API 配額限制怎麼辦？

**A**: 配額管理策略：

1. **檢查配額使用情況**
   - 在 Google Cloud Console 中查看 API 使用量
   - 確認是否接近配額限制

2. **調整請求頻率**
   ```javascript
   // 調整 API 限速設定
   PropertiesService.getScriptProperties().setProperty('API_RATE_LIMIT', '30');
   ```

3. **申請增加配額**
   - 聯絡 Google Cloud 支援
   - 申請增加 Classroom API 配額

4. **優化 API 使用**
   - 使用快取減少重複請求
   - 批次處理相關操作

### Q9: 執行時間超過 6 分鐘限制？

**A**: Google Apps Script 有 6 分鐘執行時間限制：

1. **減少批次大小**
   ```javascript
   // 調整為較小的批次
   PropertiesService.getScriptProperties().setProperty('BATCH_SIZE', '20');
   ```

2. **使用觸發器**
   - 設定時間驅動的觸發器
   - 分批處理大量資料

3. **實作斷點續傳**
   - 系統會自動保存處理進度
   - 可以從中斷點繼續處理

## 資料與格式

### Q10: 支援哪些資料格式？

**A**: 支援的格式：

1. **工作表格式**
   - Google Sheets 原生格式
   - 標準的行列結構

2. **資料類型**
   - 文字（課程名稱、姓名、Email）
   - 日期（ISO 8601 格式）
   - 狀態（文字或布林值）

3. **必要欄位**
   - 課程：課程名稱、課程ID
   - 成員：姓名、Email、角色

### Q11: 如何處理特殊字元？

**A**: 特殊字元處理：

1. **支援的字元**
   - 繁體中文字元
   - 英文字母和數字
   - 常用標點符號

2. **避免的字元**
   - 控制字元
   - 某些特殊符號（如 `<>|"*?`）

3. **編碼問題**
   - 使用 UTF-8 編碼
   - 確保資料來源編碼正確

### Q12: 資料驗證失敗怎麼辦？

**A**: 資料驗證問題：

1. **檢查必要欄位**
   - 確認所有必要欄位都有資料
   - 檢查資料格式是否正確

2. **Email 格式驗證**
   - 確認 Email 地址格式正確
   - 檢查是否有重複的 Email

3. **課程 ID 驗證**
   - 確認課程 ID 存在且有效
   - 檢查權限是否足夠

## 故障排除

### Q13: 如何查看詳細的錯誤訊息？

**A**: 錯誤診斷方法：

1. **Google Apps Script 日誌**
   - 開啟 Google Apps Script 專案
   - 點選「執行」→「查看執行記錄」
   - 查看詳細的錯誤訊息

2. **系統日誌功能**
   - 使用「匯出操作日誌」功能
   - 查看處理過程中的詳細記錄

3. **除錯模式**
   ```javascript
   // 啟用除錯模式
   PropertiesService.getScriptProperties().setProperty('DEBUG_MODE', 'true');
   ```

### Q14: 系統完全無法運作怎麼辦？

**A**: 系統重置步驟：

1. **重新部署程式碼**
   ```bash
   # 重新推送所有檔案
   clasp push --force
   ```

2. **清除所有設定**
   ```javascript
   // 清除所有屬性
   PropertiesService.getScriptProperties().deleteAll();
   ```

3. **重新初始化**
   - 重新執行設定腳本
   - 重新授權所有權限

4. **聯絡支援**
   - 如果問題持續，請聯絡技術支援
   - 提供詳細的錯誤訊息和操作步驟

## 技術支援

### Q15: 如何獲得技術支援？

**A**: 支援管道：

1. **GitHub Issues**
   - 在專案的 GitHub 頁面提交 Issue
   - 提供詳細的問題描述和錯誤訊息

2. **文件資源**
   - 查看 [故障排除指南](./故障排除.md)
   - 閱讀 [API 參考文件](./API參考.md)

3. **社群支援**
   - 加入使用者社群
   - 與其他使用者交流經驗

4. **專業支援**
   - 聯絡開發團隊
   - 申請專業技術支援服務

---

如果您的問題沒有在此列表中，請參考 [故障排除指南](./故障排除.md) 或聯絡我們的技術支援團隊。